---
# Basic CRUD Demo Test - Works without OAuth
# Demonstrates the CRUD pattern using httpbin.org

test_name: Basic CRUD Demo - Create and Read
includes:
  - !include tavern_config.yaml
marks:
  - crud
  - demo
stages:
  - name: Simulate CREATE - Post Data
    request:
      url: "https://httpbin.org/post"
      method: POST
      json:
        client_name: "TAVERN_DemoClient"
        client_email: "demo@tavern-test.com"
        case_type: "GENERAL_INQUIRY"
        status: "OPEN"
    response:
      status_code: 200
      json:
        json:
          client_name: "TAVERN_DemoClient"
          client_email: "demo@tavern-test.com"
          case_type: "GENERAL_INQUIRY"
          status: "OPEN"
        url: "https://httpbin.org/post"
      save:
        json:
          demo_case_data: json

  - name: Simulate READ - Get Data
    request:
      url: "https://httpbin.org/get"
      method: GET
      params:
        client_name: "{demo_case_data.client_name}"
    response:
      status_code: 200
      json:
        args:
          client_name: "TAVERN_DemoClient"
        url: !anystr

---
test_name: Basic CRUD Demo - Update Pattern
includes:
  - !include tavern_config.yaml
marks:
  - crud
  - demo
stages:
  - name: Simulate UPDATE - Put Data  
    request:
      url: "https://httpbin.org/put"
      method: PUT
      json:
        case_id: "demo-123-456"
        status: "CLOSED"
        updated_at: "2025-01-24T12:00:00Z"
    response:
      status_code: 200
      json:
        json:
          case_id: "demo-123-456"
          status: "CLOSED"
          updated_at: "2025-01-24T12:00:00Z"
        url: "https://httpbin.org/put"

  - name: Simulate DELETE - Delete Data
    request:
      url: "https://httpbin.org/delete"
      method: DELETE
      json:
        case_id: "demo-123-456"
    response:
      status_code: 200
      json:
        json:
          case_id: "demo-123-456"
        url: "https://httpbin.org/delete"